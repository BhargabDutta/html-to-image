<!DOCTYPE html>
<html>

<head>
    <title>Character Selection MOO ICT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body{
            background-image: linear-gradient(white,black);
        }
        .passcode-button {
            position: relative;
            display: none;
            color: #fff;
            font-size: 15px;
            padding: 10px;
            border-radius: 13px;
            background-image: linear-gradient(blue, rgb(0, 110, 153));
            cursor: pointer;
            margin-top: 20px;
        }

        .next-button {
            position: relative;
            display: none;
            color: #fff;
            font-size: 15px;
            padding: 10px;
            border-radius: 13px;
            background-image: linear-gradient(green, rgb(0, 110, 153));
            cursor: pointer;
            margin-top: 20px;
        }

        .passcode-container {
            margin-top: 20px;
            display: none;
        }

        .copy-button {
            margin-top: 10px;
            color: #fff;
            font-size: 15px;
            padding: 10px;
            border-radius: 13px;
            background-image: linear-gradient(rgb(0, 174, 255), rgb(0, 110, 153));
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1 style="text-align: center; padding: 10px;"> Generate and Download Your Badge to proceed</h1>
    <div style="display: flex; flex-direction: row; width: fit-content; position: relative; left: 0; right: 0; margin: auto; padding: 2%;">
        <div id="capture" style="padding: 10px; background: transparent;">
            <div id="container"
                style="width: 500px; height: 500px; margin: 10px; background-color: black; border-radius: 20px; text-align: center;">
                <div id="image" style="height: 100%; width: 100%; overflow: hidden; position: relative;">
                    <div id="name"
                        style="position: absolute; z-index: 99999; font-size: 30pt; font-family: sans-serif; filter: drop-shadow(0 0 0.90rem rgb(0, 0, 0)); padding: 40px; color: white; font-weight: bold;">
                        Your Name</div>
                    <img id="img" src="images/jin.png" alt=""
                        style="margin-top: 10px; height: auto; max-width: 650px; animation: gloweffect 2s infinite;">
                </div>
            </div>
        </div>
        <div id="controls" style="margin-top: 20px;">
            <div style="width: 500px; height: auto;">
                <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Enter Your Name</label>
                    <input type="text" class="form-control" id="userName" placeholder="Name"
                        oninput="checkInputFilled()">
                </div>
            </div>
            <div> Choose your gender</div>
            <div id="jin" onclick="ChangeCharacter('jin')"
                style="position: relative; display: inline-block; color: #fff; font-size: 15px; padding: 10px; border-radius: 13px; background-image: linear-gradient(blue, rgb(0, 110, 153)); cursor: pointer;">Male</div>
            <div id="paul" onclick="ChangeCharacter('paul')"
                style="position: relative; display: inline-block; color: #fff; font-size: 15px; padding: 10px; border-radius: 13px; background-image: linear-gradient(blue, rgb(0, 110, 153)); cursor: pointer;">Female</div>
            <div>
                <div onclick="getAndDisplayPasscode()" id="passcodeButton"
                    style="position: relative; display: none; color: #fff; font-size: 15px; padding: 10px; border-radius: 13px; background-image: linear-gradient(blue, rgb(0, 110, 153)); cursor: pointer; margin-top: 20px;">Download Image</div>
                <!-- <div id="nextButton"
                    style="position: relative; display: none; color: #fff; font-size: 15px; padding: 10px; border-radius: 13px; background-image: linear-gradient(green, rgb(0, 110, 153)); cursor: pointer; margin-top: 20px;">
                    Next
                </div>  -->
            </div>
            <div class="passcode-container" id="passcodeContainer">
                <div id="passcodeText" style="color: white;">Passcode: hello world</div>
                <div onclick="copyPasscode()" class="copy-button">Copy to Clipboard</div>
            </div>
            <div id="nextButton"
                    style="display: none; color: #fff; font-size: 15px; padding: 10px; border-radius: 13px; background-image: linear-gradient(rgb(0, 128, 122), rgb(0, 110, 153)); cursor: pointer; margin-top: 20px; width: 100%; text-align: center;">
                    Next
                </div> 
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        function checkInputFilled() {
            var userName = document.getElementById("userName").value.trim();
            var passcodeButton = document.getElementById('passcodeButton');

            if (userName !== '') {
                passcodeButton.style.display = 'inline-block';
            } else {
                passcodeButton.style.display = 'none';
            }
        }

        function getAndDisplayPasscode() {
            var userName = document.getElementById("userName").value.trim();

            if (userName === '') {
                alert('Please fill in your name before getting the passcode.');
                return;
            }

            html2canvas(document.querySelector("#capture")).then(canvas => {
                var link = document.createElement('a');
                link.download = 'character_selection.png';
                link.href = canvas.toDataURL('image/png');
                link.click();

                // Show the passcode and copy button after generating the passcode
                document.getElementById('passcodeContainer').style.display = 'block';
            });
        }

        function copyPasscode() {
            var passcodeText = "hello world";
            var tempInput = document.createElement("input");
            tempInput.value = passcodeText;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand("copy");
            document.body.removeChild(tempInput);
            alert("Passcode copied to clipboard!");

            // Show the nextButton after copying the passcode
            document.getElementById('nextButton').style.display = 'inline-block';
        }

        function ChangeCharacter(character) {
            var userName = document.getElementById("userName").value;
            var characterName = "";

            switch (character) {
                case "jin":
                    document.getElementById("img").src = "images/jin.png";
                    characterName = "Jin Kazama";
                    break;
                case "paul":
                    document.getElementById("img").src = "images/paul.png";
                    characterName = "Paul Phoenix";
                    break;
            }

            // Update the name with user input
            document.getElementById("name").innerHTML = userName ? userName : characterName;

            // Check if input is filled after character change
            checkInputFilled();
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>
